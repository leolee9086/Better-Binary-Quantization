var at=Object.defineProperty;var ct=(e,t,r)=>t in e?at(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var E=(e,t,r)=>ct(e,typeof t!="symbol"?t+"":t,r);let n;function I(e){A===y.length&&y.push(y.length+1);const t=A;return A=y[t],y[t]=e,t}function N(e,t){if(!(e instanceof t))throw new Error(`expected instance of ${t.name}`)}function ut(e){e<132||(y[e]=A,A=e)}function B(e,t){return e=e>>>0,J().subarray(e/4,e/4+t)}function H(e,t){return e=e>>>0,dt().subarray(e/4,e/4+t)}function G(e,t){return e=e>>>0,v().subarray(e/1,e/1+t)}let h=null;function a(){return(h===null||h.buffer.detached===!0||h.buffer.detached===void 0&&h.buffer!==n.memory.buffer)&&(h=new DataView(n.memory.buffer)),h}let x=null;function J(){return(x===null||x.byteLength===0)&&(x=new Float32Array(n.memory.buffer)),x}let k=null;function dt(){return(k===null||k.byteLength===0)&&(k=new Int32Array(n.memory.buffer)),k}function C(e,t){return e=e>>>0,gt(e,t)}let q=null;function v(){return(q===null||q.byteLength===0)&&(q=new Uint8Array(n.memory.buffer)),q}function R(e){return y[e]}function wt(e,t){try{return e.apply(this,t)}catch(r){n.__wbindgen_export(I(r))}}let y=new Array(128).fill(void 0);y.push(void 0,null,!0,!1);let A=y.length;function j(e){return e==null}function g(e,t){const r=t(e.length*1,1)>>>0;return v().set(e,r/1),u=e.length,r}function b(e,t){const r=t(e.length*4,4)>>>0;return J().set(e,r/4),u=e.length,r}function M(e,t,r){if(r===void 0){const c=F.encode(e),d=t(c.length,1)>>>0;return v().subarray(d,d+c.length).set(c),u=c.length,d}let _=e.length,i=t(_,1)>>>0;const o=v();let s=0;for(;s<_;s++){const c=e.charCodeAt(s);if(c>127)break;o[i+s]=c}if(s!==_){s!==0&&(e=e.slice(s)),i=r(i,_,_=s+e.length*3,1)>>>0;const c=v().subarray(i+s,i+_),d=F.encodeInto(e,c);s+=d.written,i=r(i,_,s,1)>>>0}return u=s,i}function p(e){const t=R(e);return ut(e),t}let W=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});W.decode();const pt=2146435072;let T=0;function gt(e,t){return T+=t,T>=pt&&(W=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}),W.decode(),T=t),W.decode(v().subarray(e,e+t))}const F=new TextEncoder;"encodeInto"in F||(F.encodeInto=function(e,t){const r=F.encode(e);return t.set(r),{read:e.length,written:r.length}});let u=0;const V=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(e=>n.__wbg_wasmbinaryquantizedscorer_free(e>>>0,1)),P=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(e=>n.__wbg_wasmquantizationresult_free(e>>>0,1)),X=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(e=>n.__wbg_wasmscalarquantizer_free(e>>>0,1)),D=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(e=>n.__wbg_wasmvector_free(e>>>0,1)),bt=Object.freeze({Euclidean:0,0:"Euclidean",Cosine:1,1:"Cosine",MaximumInnerProduct:2,2:"MaximumInnerProduct"});class L{__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,V.unregister(this),t}free(){const t=this.__destroy_into_raw();n.__wbg_wasmbinaryquantizedscorer_free(t,0)}constructor(t){try{const o=n.__wbindgen_add_to_stack_pointer(-16),s=M(t,n.__wbindgen_export2,n.__wbindgen_export3),c=u;n.wasmbinaryquantizedscorer_new(o,s,c);var r=a().getInt32(o+4*0,!0),_=a().getInt32(o+4*1,!0),i=a().getInt32(o+4*2,!0);if(i)throw p(_);return this.__wbg_ptr=r>>>0,V.register(this,this.__wbg_ptr,this),this}finally{n.__wbindgen_add_to_stack_pointer(16)}}compute_quantized_score(t,r,_,i,o,s,c,d,w,l,f,O,tt){try{const S=n.__wbindgen_add_to_stack_pointer(-16),_t=g(t,n.__wbindgen_export2),it=u,ot=g(s,n.__wbindgen_export2),st=u;n.wasmbinaryquantizedscorer_compute_quantized_score(S,this.__wbg_ptr,_t,it,r,_,i,o,ot,st,c,d,w,l,f,O,tt);var et=a().getFloat32(S+4*0,!0),nt=a().getInt32(S+4*1,!0),rt=a().getInt32(S+4*2,!0);if(rt)throw p(nt);return et}finally{n.__wbindgen_add_to_stack_pointer(16)}}}Symbol.dispose&&(L.prototype[Symbol.dispose]=L.prototype.free);class z{static __wrap(t){t=t>>>0;const r=Object.create(z.prototype);return r.__wbg_ptr=t,P.register(r,r.__wbg_ptr,r),r}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,P.unregister(this),t}free(){const t=this.__destroy_into_raw();n.__wbg_wasmquantizationresult_free(t,0)}get lower_interval(){return n.__wbg_get_wasmquantizationresult_lower_interval(this.__wbg_ptr)}set lower_interval(t){n.__wbg_set_wasmquantizationresult_lower_interval(this.__wbg_ptr,t)}get upper_interval(){return n.__wbg_get_wasmquantizationresult_upper_interval(this.__wbg_ptr)}set upper_interval(t){n.__wbg_set_wasmquantizationresult_upper_interval(this.__wbg_ptr,t)}get additional_correction(){return n.__wbg_get_wasmquantizationresult_additional_correction(this.__wbg_ptr)}set additional_correction(t){n.__wbg_set_wasmquantizationresult_additional_correction(this.__wbg_ptr,t)}get quantized_component_sum(){return n.__wbg_get_wasmquantizationresult_quantized_component_sum(this.__wbg_ptr)}set quantized_component_sum(t){n.__wbg_set_wasmquantizationresult_quantized_component_sum(this.__wbg_ptr,t)}constructor(t,r,_,i){const o=n.wasmquantizationresult_new(t,r,_,i);return this.__wbg_ptr=o>>>0,P.register(this,this.__wbg_ptr,this),this}}Symbol.dispose&&(z.prototype[Symbol.dispose]=z.prototype.free);class U{__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,X.unregister(this),t}free(){const t=this.__destroy_into_raw();n.__wbg_wasmscalarquantizer_free(t,0)}constructor(t,r,_){try{const w=n.__wbindgen_add_to_stack_pointer(-16);var i=j(_)?0:M(_,n.__wbindgen_export2,n.__wbindgen_export3),o=u;n.wasmscalarquantizer_new(w,j(t)?4294967297:Math.fround(t),j(r)?4294967297:r>>>0,i,o);var s=a().getInt32(w+4*0,!0),c=a().getInt32(w+4*1,!0),d=a().getInt32(w+4*2,!0);if(d)throw p(c);return this.__wbg_ptr=s>>>0,X.register(this,this.__wbg_ptr,this),this}finally{n.__wbindgen_add_to_stack_pointer(16)}}scalar_quantize(t,r,_){try{const c=n.__wbindgen_add_to_stack_pointer(-16),d=b(t,n.__wbindgen_export2),w=u,l=b(_,n.__wbindgen_export2),f=u;n.wasmscalarquantizer_scalar_quantize(c,this.__wbg_ptr,d,w,r,l,f);var i=a().getInt32(c+4*0,!0),o=a().getInt32(c+4*1,!0),s=a().getInt32(c+4*2,!0);if(s)throw p(o);return p(i)}finally{n.__wbindgen_add_to_stack_pointer(16)}}static pack_as_binary(t){try{const c=n.__wbindgen_add_to_stack_pointer(-16),d=g(t,n.__wbindgen_export2),w=u;n.wasmscalarquantizer_pack_as_binary(c,d,w);var r=a().getInt32(c+4*0,!0),_=a().getInt32(c+4*1,!0),i=a().getInt32(c+4*2,!0),o=a().getInt32(c+4*3,!0);if(o)throw p(i);var s=G(r,_).slice();return n.__wbindgen_export4(r,_*1,1),s}finally{n.__wbindgen_add_to_stack_pointer(16)}}}Symbol.dispose&&(U.prototype[Symbol.dispose]=U.prototype.free);class m{static __wrap(t){t=t>>>0;const r=Object.create(m.prototype);return r.__wbg_ptr=t,D.register(r,r.__wbg_ptr,r),r}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,D.unregister(this),t}free(){const t=this.__destroy_into_raw();n.__wbg_wasmvector_free(t,0)}constructor(t){const r=b(t,n.__wbindgen_export2),_=u,i=n.wasmvector_new(r,_);return this.__wbg_ptr=i>>>0,D.register(this,this.__wbg_ptr,this),this}static from_array(t){const r=b(t,n.__wbindgen_export2),_=u,i=n.wasmvector_from_array(r,_);return m.__wrap(i)}dimension(){return n.wasmvector_dimension(this.__wbg_ptr)>>>0}get_data(){try{const i=n.__wbindgen_add_to_stack_pointer(-16);n.wasmvector_get_data(i,this.__wbg_ptr);var t=a().getInt32(i+4*0,!0),r=a().getInt32(i+4*1,!0),_=B(t,r).slice();return n.__wbindgen_export4(t,r*4,4),_}finally{n.__wbindgen_add_to_stack_pointer(16)}}magnitude(){return n.wasmvector_magnitude(this.__wbg_ptr)}normalize(){n.wasmvector_normalize(this.__wbg_ptr)}similarity(t,r){try{const s=n.__wbindgen_add_to_stack_pointer(-16);N(t,m);const c=M(r,n.__wbindgen_export2,n.__wbindgen_export3),d=u;n.wasmvector_similarity(s,this.__wbg_ptr,t.__wbg_ptr,c,d);var _=a().getFloat32(s+4*0,!0),i=a().getInt32(s+4*1,!0),o=a().getInt32(s+4*2,!0);if(o)throw p(i);return _}finally{n.__wbindgen_add_to_stack_pointer(16)}}dot(t){return N(t,m),n.wasmvector_dot(this.__wbg_ptr,t.__wbg_ptr)}}Symbol.dispose&&(m.prototype[Symbol.dispose]=m.prototype.free);function lt(){n.init()}function ft(){let e,t;try{const i=n.__wbindgen_add_to_stack_pointer(-16);n.version(i);var r=a().getInt32(i+4*0,!0),_=a().getInt32(i+4*1,!0);return e=r,t=_,C(r,_)}finally{n.__wbindgen_add_to_stack_pointer(16),n.__wbindgen_export4(e,t,1)}}function yt(e,t,r,_){try{const c=n.__wbindgen_add_to_stack_pointer(-16),d=g(e,n.__wbindgen_export2),w=u,l=g(t,n.__wbindgen_export2),f=u;n.wasm_compute_batch_four_bit_dot_product(c,d,w,l,f,r,_);var i=a().getInt32(c+4*0,!0),o=a().getInt32(c+4*1,!0),s=H(i,o).slice();return n.__wbindgen_export4(i,o*4,4),s}finally{n.__wbindgen_add_to_stack_pointer(16)}}function mt(e,t,r,_){try{const c=n.__wbindgen_add_to_stack_pointer(-16),d=g(e,n.__wbindgen_export2),w=u,l=g(t,n.__wbindgen_export2),f=u;n.wasm_compute_batch_one_bit_dot_product(c,d,w,l,f,r,_);var i=a().getInt32(c+4*0,!0),o=a().getInt32(c+4*1,!0),s=H(i,o).slice();return n.__wbindgen_export4(i,o*4,4),s}finally{n.__wbindgen_add_to_stack_pointer(16)}}function ht(e,t){try{const o=n.__wbindgen_add_to_stack_pointer(-16),s=b(e,n.__wbindgen_export2),c=u,d=b(t,n.__wbindgen_export2),w=u;n.wasm_compute_cosine_similarity(o,s,c,d,w);var r=a().getFloat32(o+4*0,!0),_=a().getInt32(o+4*1,!0),i=a().getInt32(o+4*2,!0);if(i)throw p(_);return r}finally{n.__wbindgen_add_to_stack_pointer(16)}}function vt(e,t){const r=b(e,n.__wbindgen_export2),_=u,i=b(t,n.__wbindgen_export2),o=u;return n.wasm_compute_dot_product(r,_,i,o)}function zt(e,t){try{const o=n.__wbindgen_add_to_stack_pointer(-16),s=b(e,n.__wbindgen_export2),c=u,d=b(t,n.__wbindgen_export2),w=u;n.wasm_compute_euclidean_distance(o,s,c,d,w);var r=a().getFloat32(o+4*0,!0),_=a().getInt32(o+4*1,!0),i=a().getInt32(o+4*2,!0);if(i)throw p(_);return r}finally{n.__wbindgen_add_to_stack_pointer(16)}}function It(e,t){try{const o=n.__wbindgen_add_to_stack_pointer(-16),s=g(e,n.__wbindgen_export2),c=u,d=g(t,n.__wbindgen_export2),w=u;n.wasm_compute_int1_bit_dot_product(o,s,c,d,w);var r=a().getInt32(o+4*0,!0),_=a().getInt32(o+4*1,!0),i=a().getInt32(o+4*2,!0);if(i)throw p(_);return r}finally{n.__wbindgen_add_to_stack_pointer(16)}}function xt(e,t){try{const o=n.__wbindgen_add_to_stack_pointer(-16),s=g(e,n.__wbindgen_export2),c=u,d=g(t,n.__wbindgen_export2),w=u;n.wasm_compute_int1_bit_dot_product(o,s,c,d,w);var r=a().getInt32(o+4*0,!0),_=a().getInt32(o+4*1,!0),i=a().getInt32(o+4*2,!0);if(i)throw p(_);return r}finally{n.__wbindgen_add_to_stack_pointer(16)}}function kt(e,t){try{const o=n.__wbindgen_add_to_stack_pointer(-16),s=g(e,n.__wbindgen_export2),c=u,d=g(t,n.__wbindgen_export2),w=u;n.wasm_compute_int1_bit_dot_product(o,s,c,d,w);var r=a().getInt32(o+4*0,!0),_=a().getInt32(o+4*1,!0),i=a().getInt32(o+4*2,!0);if(i)throw p(_);return r}finally{n.__wbindgen_add_to_stack_pointer(16)}}function qt(e,t,r){try{const s=n.__wbindgen_add_to_stack_pointer(-16),c=b(e,n.__wbindgen_export2),d=u,w=b(t,n.__wbindgen_export2),l=u,f=M(r,n.__wbindgen_export2,n.__wbindgen_export3),O=u;n.wasm_compute_similarity(s,c,d,w,l,f,O);var _=a().getFloat32(s+4*0,!0),i=a().getInt32(s+4*1,!0),o=a().getInt32(s+4*2,!0);if(o)throw p(i);return _}finally{n.__wbindgen_add_to_stack_pointer(16)}}function At(e){const t=b(e,n.__wbindgen_export2),r=u;return n.wasm_compute_vector_magnitude(t,r)}function Ft(e,t,r){try{const s=n.__wbindgen_add_to_stack_pointer(-16);n.wasm_create_random_vector(s,e,t,r);var _=a().getInt32(s+4*0,!0),i=a().getInt32(s+4*1,!0),o=B(_,i).slice();return n.__wbindgen_export4(_,i*4,4),o}finally{n.__wbindgen_add_to_stack_pointer(16)}}function St(e){try{const i=n.__wbindgen_add_to_stack_pointer(-16);n.wasm_create_zero_vector(i,e);var t=a().getInt32(i+4*0,!0),r=a().getInt32(i+4*1,!0),_=B(t,r).slice();return n.__wbindgen_export4(t,r*4,4),_}finally{n.__wbindgen_add_to_stack_pointer(16)}}const Rt=new Set(["basic","cors","default"]);async function Wt(e,t){if(typeof Response=="function"&&e instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(e,t)}catch(_){if(e.ok&&Rt.has(e.type)&&e.headers.get("Content-Type")!=="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",_);else throw _}const r=await e.arrayBuffer();return await WebAssembly.instantiate(r,t)}else{const r=await WebAssembly.instantiate(e,t);return r instanceof WebAssembly.Instance?{instance:r,module:e}:r}}function K(){const e={};return e.wbg={},e.wbg.__wbg___wbindgen_throw_dd24417ed36fc46e=function(t,r){throw new Error(C(t,r))},e.wbg.__wbg_new_1ba21ce319a06297=function(){const t=new Object;return I(t)},e.wbg.__wbg_new_from_slice_f9c22b9153b26992=function(t,r){const _=new Uint8Array(G(t,r));return I(_)},e.wbg.__wbg_set_781438a03c0c3c81=function(){return wt(function(t,r,_){return Reflect.set(R(t),R(r),R(_))},arguments)},e.wbg.__wbg_wasmquantizationresult_new=function(t){const r=z.__wrap(t);return I(r)},e.wbg.__wbindgen_cast_2241b6af4c4b2941=function(t,r){const _=C(t,r);return I(_)},e.wbg.__wbindgen_object_drop_ref=function(t){p(t)},e}function Z(e,t){return n=e.exports,Q.__wbindgen_wasm_module=t,h=null,x=null,k=null,q=null,n.__wbindgen_start(),n}function Mt(e){if(n!==void 0)return n;typeof e<"u"&&(Object.getPrototypeOf(e)===Object.prototype?{module:e}=e:console.warn("using deprecated parameters for `initSync()`; pass a single object instead"));const t=K();e instanceof WebAssembly.Module||(e=new WebAssembly.Module(e));const r=new WebAssembly.Instance(e,t);return Z(r,e)}async function Q(e){if(n!==void 0)return n;typeof e<"u"&&(Object.getPrototypeOf(e)===Object.prototype?{module_or_path:e}=e:console.warn("using deprecated parameters for the initialization function; pass a single object instead")),typeof e>"u"&&(e=new URL(""+new URL("better_binary_quantization_bg-DybT2Riu.wasm",import.meta.url).href,import.meta.url));const t=K();(typeof e=="string"||typeof Request=="function"&&e instanceof Request||typeof URL=="function"&&e instanceof URL)&&(e=fetch(e));const{instance:r,module:_}=await Wt(await e,t);return Z(r,_)}const Y=Object.freeze(Object.defineProperty({__proto__:null,SimilarityFunction:bt,WasmBinaryQuantizedScorer:L,WasmQuantizationResult:z,WasmScalarQuantizer:U,WasmVector:m,default:Q,init:lt,initSync:Mt,version:ft,wasm_compute_batch_four_bit_dot_product:yt,wasm_compute_batch_one_bit_dot_product:mt,wasm_compute_cosine_similarity:ht,wasm_compute_dot_product:vt,wasm_compute_euclidean_distance:zt,wasm_compute_int1_bit_dot_product:It,wasm_compute_int4_bit_dot_product:xt,wasm_compute_quantized_dot_product:kt,wasm_compute_similarity:qt,wasm_compute_vector_magnitude:At,wasm_create_random_vector:Ft,wasm_create_zero_vector:St},Symbol.toStringTag,{value:"Module"}));class ${static async init(t){return this.instance?this.instance:this.initializationPromise?this.initializationPromise:(this.initializationPromise=(async()=>(await Q(t),this.instance=Y,Y))(),this.initializationPromise)}static getModule(){if(!this.instance)throw new Error("WASM module not initialized. Call WasmProvider.init() first.");return this.instance}static isInitialized(){return!!this.instance}}E($,"instance",null),E($,"initializationPromise",null);export{bt as SimilarityFunction,L as WasmBinaryQuantizedScorer,$ as WasmProvider,z as WasmQuantizationResult,U as WasmScalarQuantizer,m as WasmVector,lt as init,Mt as initSync,ft as version,yt as wasm_compute_batch_four_bit_dot_product,mt as wasm_compute_batch_one_bit_dot_product,ht as wasm_compute_cosine_similarity,vt as wasm_compute_dot_product,zt as wasm_compute_euclidean_distance,It as wasm_compute_int1_bit_dot_product,xt as wasm_compute_int4_bit_dot_product,kt as wasm_compute_quantized_dot_product,qt as wasm_compute_similarity,At as wasm_compute_vector_magnitude,Ft as wasm_create_random_vector,St as wasm_create_zero_vector};
